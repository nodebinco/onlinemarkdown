#!/usr/bin/env node
/**
 * Build scripts/translations/af.json from messages/nl.json with Dutch→Afrikaans substitutions.
 * Run: node scripts/build-af-from-nl.mjs
 * Then: node scripts/apply-translations-from-json.mjs af scripts/translations/af.json
 */
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));
const nlPath = path.join(__dirname, '../messages/nl.json');
const enPath = path.join(__dirname, '../messages/en.json');
const outPath = path.join(__dirname, 'translations/af.json');

const nl = JSON.parse(fs.readFileSync(nlPath, 'utf8'));
const en = JSON.parse(fs.readFileSync(enPath, 'utf8'));

// Dutch → Afrikaans substitutions
const subs = [
  [/Over ons/g, 'Oor ons'],
  [/over ons/g, 'oor ons'],
  [/Ons verhaal/g, 'Ons storie'],
  [/ons verhaal/g, 'ons storie'],
  [/gereedskap/g, 'gereedskap'], // same
  [/Gereedskap/g, 'Gereedskap'],
  [/Syntaxis/g, 'Sintaksis'],
  [/syntaxis/g, 'sintaksis'],
  [/Contact/g, 'Kontak'],
  [/contact/g, 'kontak'],
  [/documentatie/g, 'dokumentasie'],
  [/Documentatie/g, 'Dokumentasie'],
  [/documenten/g, 'dokumente'],
  [/document/g, 'dokument'],
  [/Document/g, 'Dokument'],
  [/pagina/g, 'bladsy'],
  [/Pagina/g, 'Bladsy'],
  [/pagina's/g, 'bladsye'],
  [/editor/g, 'redigeerder'],
  [/Editor/g, 'Redigeerder'],
  [/schrijven/g, 'skryf'],
  [/Schrijven/g, 'Skryf'],
  [/schrijf/g, 'skryf'],
  [/Schrijf/g, 'Skryf'],
  [/preview/g, 'voorskou'],
  [/Preview/g, 'Voorskou'],
  [/opmaak/g, 'opmaak'], // similar
  [/Opmaak/g, 'Opmaak'],
  [/inhoud/g, 'inhoud'],
  [/Inhoud/g, 'Inhoud'],
  [/lijst/g, 'lys'],
  [/Lijst/g, 'Lys'],
  [/lijsten/g, 'lyste'],
  [/Link/g, 'Skakel'],
  [/link/g, 'skakel'],
  [/links/g, 'skakels'],
  [/Afbeelding/g, 'Prent'],
  [/afbeelding/g, 'prent'],
  [/afbeeldingen/g, 'prente'],
  [/tabel/g, 'tabel'],
  [/Tabel/g, 'Tabel'],
  [/tabellen/g, 'tabelle'],
  [/code/g, 'kode'],
  [/Code/g, 'Kode'],
  [/opslaan/g, 'stoor'],
  [/Opslaan/g, 'Stoor'],
  [/openen/g, 'open'],
  [/Openen/g, 'Open'],
  [/sluiten/g, 'sluit'],
  [/Sluiten/g, 'Sluit'],
  [/annuleren/g, 'kanselleer'],
  [/Annuleren/g, 'Kanselleer'],
  [/invoegen/g, 'voeg in'],
  [/Invoegen/g, 'Voeg in'],
  [/Nieuw/g, 'Nuut'],
  [/nieuw/g, 'nuut'],
  [/Nieuwe/g, 'Nuwe'],
  [/nieuwe/g, 'nuwe'],
  [/Kop/g, 'Opskrif'],
  [/kop/g, 'opskrif'],
  [/koppen/g, 'opskrifte'],
  [/Vet/g, 'Vet'],
  [/vet/g, 'vet'],
  [/Cursief/g, 'Kursief'],
  [/cursief/g, 'kursief'],
  [/Citaat/g, 'Aanhaling'],
  [/citaat/g, 'aanhaling'],
  [/citaten/g, 'aanhalings'],
  [/spiekbrief/g, 'spiekbrief'],
  [/Spiekbrief/g, 'Spiekbrief'],
  [/element/g, 'element'],
  [/Element/g, 'Element'],
  [/elementen/g, 'elemente'],
  [/regelbreuk/g, 'reëlbreuk'],
  [/Regelbreuk/g, 'Reëlbreuk'],
  [/voetnoot/g, 'voetnoot'],
  [/Voetnoot/g, 'Voetnoot'],
  [/definitielijst/g, 'definiselys'],
  [/Definitielijst/g, 'Definiselys'],
  [/horizontale lijn/g, 'horisontale lyn'],
  [/Horizontale lijn/g, 'Horisontale lyn'],
  [/codeblok/g, 'kodeblok'],
  [/Codeblok/g, 'Kodeblok'],
  [/codeblokken/g, 'kodeblokke'],
  [/inlinecode/g, 'inlynkode'],
  [/Inlinecode/g, 'Inlynkode'],
  [/markering/g, 'markering'],
  [/Markering/g, 'Markering'],
  [/subscript/g, 'onderskrif'],
  [/Subscript/g, 'Onderskrif'],
  [/superscript/g, 'boskrif'],
  [/Superscript/g, 'Boskrif'],
  [/doorhalen/g, 'deurhaal'],
  [/Doorhalen/g, 'Deurhaal'],
  [/geordende lijst/g, 'genommerde lys'],
  [/Geordende lijst/g, 'Genommerde lys'],
  [/ongenummerde lijst/g, 'ongeordende lys'],
  [/ongenummerde lijst/g, 'ongeordende lys'],
  [/uitgebreide/g, 'uitgebreide'],
  [/Uitgebreide/g, 'Uitgebreide'],
  [/structuur/g, 'struktuur'],
  [/Structuur/g, 'Struktuur'],
  [/voorbeeld/g, 'voorbeeld'],
  [/Voorbeeld/g, 'Voorbeeld'],
  [/voorbeelden/g, 'voorbeelde'],
  [/snelverwijzing/g, 'vinnige verwysing'],
  [/Snelverwijzing/g, 'Vinnige verwysing'],
  [/privacy/g, 'privaatheid'],
  [/Privacy/g, 'Privaatheid'],
  [/voorwaarden/g, 'voorwaardes'],
  [/Voorwaarden/g, 'Voorwaardes'],
  [/voorwaarden & condities/g, 'voorwaardes en bepalings'],
  [/Voorwaarden & condities/g, 'Voorwaardes en bepalings'],
  [/condities/g, 'bepalings'],
  [/Condities/g, 'Bepalings'],
  [/beleid/g, 'beleid'],
  [/Beleid/g, 'Beleid'],
  [/rechten/g, 'regte'],
  [/Rechten/g, 'Regte'],
  [/alle rechten voorbehouden/g, 'alle regte voorbehou'],
  [/Alle rechten voorbehouden/g, 'Alle regte voorbehou'],
  [/informatie/g, 'inligting'],
  [/Informatie/g, 'Inligting'],
  [/verzamelen/g, 'versamel'],
  [/Verzamelen/g, 'Versamel'],
  [/gebruiken/g, 'gebruik'],
  [/Gebruiken/g, 'Gebruik'],
  [/cookies/g, 'koekies'],
  [/Cookies/g, 'Koekies'],
  [/derden/g, 'derdeparty'],
  [/Derden/g, 'Derdeparty'],
  [/diensten/g, 'dienste'],
  [/Diensten/g, 'Dienste'],
  [/beveiliging/g, 'sekuriteit'],
  [/Beveiliging/g, 'Sekuriteit'],
  [/gegevens/g, 'data'],
  [/Gegevens/g, 'Data'],
  [/kinderen/g, 'kinders'],
  [/Kinderen/g, 'Kinders'],
  [/overdracht/g, 'oordrag'],
  [/Overdracht/g, 'Oordrag'],
  [/wijzigingen/g, 'wysigings'],
  [/Wijzigingen/g, 'Wysigings'],
  [/licentie/g, 'lisensie'],
  [/Licentie/g, 'Lisensie'],
  [/gebruik/g, 'gebruik'],
  [/Gebruik/g, 'Gebruik'],
  [/vrijwaring/g, 'vrywaring'],
  [/Vrijwaring/g, 'Vrywaring'],
  [/beperkingen/g, 'beperkings'],
  [/Beperkingen/g, 'Beperkings'],
  [/gebruikersinhoud/g, 'gebruikerinhoud'],
  [/Gebruikersinhoud/g, 'Gebruikerinhoud'],
  [/verboden/g, 'verbode'],
  [/Verboden/g, 'Verbode'],
  [/beëindiging/g, 'beëindiging'],
  [/Beëindiging/g, 'Beëindiging'],
  [/toepasselijk/g, 'toepaslik'],
  [/Toepasselijk/g, 'Toepaslik'],
  [/wet/g, 'wet'],
  [/Wet/g, 'Wet'],
  [/converteren/g, 'omskep'],
  [/Converteren/g, 'Omskep'],
  [/converter/g, 'omskepter'],
  [/Converter/g, 'Omskepter'],
  [/exporteer/g, 'voer uit'],
  [/Exporteer/g, 'Voer uit'],
  [/exporteren/g, 'uitvoer'],
  [/Exporteren/g, 'Uitvoer'],
  [/veelgestelde vragen/g, 'algemene vrae'],
  [/Veelgestelde vragen/g, 'Algemene vrae'],
  [/laatst bijgewerkt/g, 'laas opdater'],
  [/Laatst bijgewerkt/g, 'Laas opdater'],
  [/aanvaarding/g, 'aanvaarding'],
  [/Aanvaarding/g, 'Aanvaarding'],
  [/contactgegevens/g, 'kontakbesonderhede'],
  [/Contactgegevens/g, 'Kontakbesonderhede'],
  [/repositorium/g, 'bewaarplek'],
  [/Repositorium/g, 'Bewaarplek'],
  [/e-mail/g, 'e-pos'],
  [/E-mail/g, 'E-pos'],
  [/antwoord/g, 'antwoord'],
  [/Antwoord/g, 'Antwoord'],
  [/antwoorden/g, 'antwoorde'],
  [/binnen/g, 'binne'],
  [/uren/g, 'uur'],
  [/dank/g, 'dankie'],
  [/Dank/g, 'Dankie'],
  [/bedankt/g, 'dankie'],
  [/Bedankt/g, 'Dankie'],
  [/eenvoudig/g, 'eenvoudig'],
  [/Eenvoudig/g, 'Eenvoudig'],
  [/snel/g, 'vinnig'],
  [/Snel/g, 'Vinnig'],
  [/gratis/g, 'gratis'],
  [/Gratis/g, 'Gratis'],
  [/open-source/g, 'oopbron'],
  [/Open-source/g, 'Oopbron'],
  [/installatie/g, 'installasie'],
  [/Installatie/g, 'Installasie'],
  [/registratie/g, 'registrasie'],
  [/Registratie/g, 'Registrasie'],
  [/klik/g, 'klik'],
  [/Klik/g, 'Klik'],
  [/klikken/g, 'klik'],
  [/Klikken/g, 'Klik'],
  [/dialoog/g, 'dialoog'],
  [/Dialoog/g, 'Dialoog'],
  [/pictogram/g, 'ikoon'],
  [/Pictogram/g, 'Ikoon'],
  [/werkbalk/g, 'werkbalk'],
  [/Werkbalk/g, 'Werkbalk'],
  [/bestand/g, 'lêer'],
  [/Bestand/g, 'Lêer'],
  [/bestanden/g, 'lêers'],
  [/Bestanden/g, 'Lêers'],
  [/aanbevolen/g, 'aanbeveel'],
  [/Aanbevolen/g, 'Aanbeveel'],
  [/bezoek/g, 'besoek'],
  [/Bezoek/g, 'Besoek'],
  [/uurwerk/g, 'horlosie'],
  [/Uurwerk/g, 'Horlosie'],
  [/tijdzone/g, 'tydsone'],
  [/Tijdzone/g, 'Tydsone'],
  [/omzetter/g, 'omskepter'],
  [/Omzetter/g, 'Omskepter'],
  [/ontwikkelaars/g, 'ontwikkelaars'],
  [/Ontwikkelaars/g, 'Ontwikkelaars'],
  [/wereldwijd/g, 'wêreldwyd'],
  [/Wereldwijd/g, 'Wêreldwyd'],
  [/steden/g, 'stede'],
  [/Steden/g, 'Stede'],
  [/suggestie/g, 'voorstel'],
  [/Suggestie/g, 'Voorstel'],
  [/suggereren/g, 'voorstel'],
  [/Beginnen/g, 'Begin'],
  [/beginnen/g, 'begin'],
  [/Beginnen met/g, 'Begin met'],
  [/beginnen met/g, 'begin met'],
  [/Cheat Sheet/g, 'Spiekbrief'],
  [/cheat sheet/g, 'spiekbrief'],
];

function applySubstitutions(str) {
  if (typeof str !== 'string') return str;
  let out = str;
  for (const [from, to] of subs) out = out.replace(from, to);
  return out;
}

const out = {};
for (const key of Object.keys(en)) {
  if (key.startsWith('$')) continue;
  const val = nl[key] !== undefined ? nl[key] : en[key];
  out[key] = typeof val === 'string' ? applySubstitutions(val) : val;
}

fs.mkdirSync(path.dirname(outPath), { recursive: true });
fs.writeFileSync(outPath, JSON.stringify(out, null, 2) + '\n', 'utf8');
console.log('Built', outPath, 'from nl.json with Afrikaans substitutions.');