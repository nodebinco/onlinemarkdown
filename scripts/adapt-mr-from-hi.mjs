#!/usr/bin/env node
/**
 * Adapt Hindi text to Marathi and write to messages/mr.json.
 * Run: node scripts/adapt-mr-from-hi.mjs
 * Reads hi.json, applies Hindi→Marathi substitutions, writes to mr.json (keeps mr's locale_* from en).
 */
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));
const mrPath = path.join(__dirname, '../messages/mr.json');
const hiPath = path.join(__dirname, '../messages/hi.json');
const enPath = path.join(__dirname, '../messages/en.json');
const hi = JSON.parse(fs.readFileSync(hiPath, 'utf8'));
const en = JSON.parse(fs.readFileSync(enPath, 'utf8'));
const j = JSON.parse(fs.readFileSync(mrPath, 'utf8'));
const localeKeySet = new Set(Object.keys(en).filter((k) => k.startsWith('locale_')));

// Hindi → Marathi substitutions (longer phrases first to avoid partial matches)
const SUBSTITUTIONS = [
  ['हमारे बारे में', 'आमच्याबद्दल'],
  ['हमारे समुदाय', 'आमच्या समुदाय'],
  ['हमारा मिशन', 'आमचे मिशन'],
  ['हमारा संपादक', 'आमचा संपादक'],
  ['हमारा प्लेटफ़ॉर्म', 'आमचे प्लॅटफॉर्म'],
  ['हमारा टूल', 'आमचे साधन'],
  ['हमारे समुदाय', 'आमच्या समुदाय'],
  ['हमारे लिए', 'आमच्यासाठी'],
  ['हमारे डेटा', 'आमच्या डेटा'],
  ['हमारे ऐप्लिकेशन', 'आमच्या अॅप्लिकेशन'],
  ['हमारी कमिऊनिटी', 'आमची समुदाय'],
  ['हमारी सेवा', 'आमची सेवा'],
  ['हमारी गोपनीयता', 'आमची गोपनीयता'],
  ['हमारी नीति', 'आमची धोरण'],
  ['हम से संपर्क', 'आमच्याशी संपर्क'],
  ['हमें', 'आम्हाला'],
  ['हम आपके', 'आम्ही तुमच्या'],
  ['हम सिर्फ', 'आम्ही फक्त'],
  ['हम एक', 'आम्ही एक'],
  ['हम निरंतर', 'आम्ही सतत'],
  ['हम नहीं', 'आम्ही नाही'],
  ['हम समय', 'आम्ही वेळ'],
  ['हम मार्कडाउन', 'आम्ही मार्कडाउन'],
  ['हम मानते', 'आम्ही मानतो'],
  ['हम विश्वास', 'आम्ही विश्वास'],
  ['हम प्रतिबद्ध', 'आम्ही वचनबद्ध'],
  ['हम सभी', 'आम्ही सर्व'],
  ['हम आपको', 'आम्ही तुम्हाला'],
  ['आपके सवालों', 'तुमच्या प्रश्नांची'],
  ['आपकी आवाज़', 'तुमचा आवाज'],
  ['आपकी सामग्री', 'तुमची माहिती'],
  ['आपकी रुचि', 'तुमची ओढ'],
  ['आपकी गोपनीयता', 'तुमची गोपनीयता'],
  ['आपको', 'तुम्हाला'],
  ['आप चाहे', 'तुम्ही का'],
  ['आप अपने', 'तुम्ही तुमच्या'],
  ['आप निम्नलिखित', 'तुम्ही खालील'],
  ['आप हमारे', 'तुम्ही आमच्या'],
  ['आप हम तक', 'तुम्ही आम्हाला'],
  ['आप सेवा', 'तुम्ही सेवा'],
  ['आप वैकल्पिक', 'तुम्ही पर्यायी'],
  ['आप बैकस्लैश', 'तुम्ही बॅकस्लॅश'],
  ['आप शब्द', 'तुम्ही शब्द'],
  ['आप आइटम', 'तुम्ही आयटम'],
  ['आप लिंक', 'तुम्ही लिंक'],
  ['आज ही', 'आजच'],
  ['के ज़रिए', 'मार्गे'],
  ['के साथ', 'सोबत'],
  ['के लिए', 'साठी'],
  ['के बारे में', 'बद्दल'],
  ['के पीछे', 'मागे'],
  ['के अनुसार', 'प्रमाणे'],
  ['के रूप में', 'म्हणून'],
  ['की ज़रूरत', 'ची गरज'],
  ['की कदर', 'ची कदर'],
  ['की तरह', 'सारखे'],
  ['की ओर', 'कडे'],
  ['का समर्थन', 'चे समर्थन'],
  ['का उपयोग', 'चा वापर'],
  ['का विवरण', 'चे वर्णन'],
  ['से जुड़ें', 'सामील व्हा'],
  ['से बाहर', 'बाहेर'],
  ['शुरू करने', 'सुरू करण्यासाठी'],
  ['शुरू करें', 'सुरू करा'],
  ['नई फ़ाइल', 'नवीन फाइल'],
  ['फ़ाइलें', 'फाइल्स'],
  ['फ़ाइल', 'फाइल'],
  ['पेज', 'पृष्ठ'],
  ['ज़रिए', 'मार्गे'],
  ['ज़रूरत', 'गरज'],
  ['ज़्यादा', 'जास्त'],
  ['इंटरफ़ेस', 'इंटरफेस'],
  ['इश्यू', 'इश्यू'],
  ['डिज़ाइन', 'डिझाइन'],
  ['प्लेटफ़ॉर्म', 'प्लॅटफॉर्म'],
  ['सहज', 'सोपे'],
  ['सहयोग', 'सहकार्य'],
  ['नवाचार', 'नावीन्य'],
  ['दस्तावेज़', 'दस्तऐवज'],
  ['दस्तावेज़ों', 'दस्तऐवजां'],
  ['उपयोगकर्ताओं', 'वापरकर्त्यां'],
  ['उपयोगकर्ता', 'वापरकर्ता'],
  ['सुझाव', 'सूचना'],
  ['प्रतिक्रिया', 'अभिप्राय'],
  ['समुदाय', 'समुदाय'],
  ['रिपॉजिटरी', 'रिपॉझिटरी'],
  ['रद्द करें', 'रद्द करा'],
  ['डालें', 'घाला'],
  ['दिखाएं', 'दाखवा'],
  ['छिपाएं', 'लपवा'],
  ['सहेजें', 'जतन करा'],
  ['खोलें', 'उघडा'],
  ['बनाएं', 'तयार करा'],
  ['करें', 'करा'],
  ['लिखें', 'लिहा'],
  ['देखें', 'पहा'],
  ['जाएं', 'जा'],
  ['हैं', 'आहेत'],
  ['है', 'आहे'],
  ['हों', 'असतील'],
  ['हो', 'असावे'],
  ['करता है', 'करते'],
  ['करती है', 'करते'],
  ['करते हैं', 'करतात'],
  ['बनाता है', 'बनवते'],
  ['देता है', 'देतो'],
  ['मदद करता है', 'मदत करते'],
  ['प्रदान करना', 'उपलब्ध करणे'],
  ['सुनिश्चित करते हुए', 'सुनिश्चित करत'],
  ['केंद्रित करना', 'केंद्रित करणे'],
  ['तुरंत', 'तात्काळ'],
  ['तत्काल', 'तात्काळ'],
  ['अपनी', 'तुमची'],
  ['अपने', 'तुमच्या'],
  ['चाहे', 'का'],
  ['चाहिए', 'पाहिजे'],
  ['सभी', 'सर्व'],
  ['सिर्फ', 'फक्त'],
  ['ज़रूर', 'नक्की'],
  ['नहीं', 'नाही'],
  ['बस', 'फक्त'],
  ['अभी', 'आत्ता'],
  ['अभी कोई', 'अजून काही'],
  ['किसी', 'कोणत्याही'],
  ['किसी भी', 'कोणत्याही'],
  ['कोई', 'काही'],
  ['ऐसा', 'असे'],
  ['इस', 'या'],
  ['उस', 'त्या'],
  ['जो', 'जे'],
  ['जिस', 'ज्या'],
  ['हर', 'प्रत्येक'],
  [' के साथ ', ' सोबत '],
  [' के लिए ', ' साठी '],
  [' के बारे में ', ' बद्दल '],
  [' के ज़रिए ', ' मार्गे '],
  [' और ', ' आणि '],
  [' लेकिन ', ' पण '],
  [' तो ', ' तर '],
  [' फिर ', ' मग '],
  [' अब ', ' आता '],
];

function adapt(text) {
  if (typeof text !== 'string') return text;
  let s = text;
  for (const [from, to] of SUBSTITUTIONS) {
    s = s.split(from).join(to);
  }
  return s;
}

let count = 0;
for (const key of Object.keys(j)) {
  if (key.startsWith('$') || localeKeySet.has(key)) continue;
  const source = hi[key];
  if (typeof source === 'string' && source) {
    const adapted = adapt(source);
    j[key] = adapted;
    if (adapted !== source) count++;
  }
}
for (const key of Object.keys(en)) {
  if (localeKeySet.has(key)) j[key] = en[key];
}

fs.writeFileSync(mrPath, JSON.stringify(j, null, 2) + '\n', 'utf8');
console.log(`Adapted ${count} keys in mr.json from Hindi to Marathi.`);
