#!/usr/bin/env node
/**
 * Build scripts/translations/ca.json from messages/es.json with Spanish→Catalan substitutions.
 * Run: node scripts/build-ca-from-es.mjs
 * Then: node scripts/apply-translations-from-json.mjs ca scripts/translations/ca.json
 */
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));
const esPath = path.join(__dirname, '../messages/es.json');
const enPath = path.join(__dirname, '../messages/en.json');
const outPath = path.join(__dirname, 'translations/ca.json');

const es = JSON.parse(fs.readFileSync(esPath, 'utf8'));
const en = JSON.parse(fs.readFileSync(enPath, 'utf8'));

// Spanish → Catalan substitutions (word/phrase level)
const subs = [
  [/Sobre nosotros/g, 'Sobre nosaltres'],
  [/nosotros/g, 'nosaltres'],
  [/Herramientas/g, 'Eines'],
  [/herramientas/g, 'eines'],
  [/herramienta/g, 'eina'],
  [/Sintaxis/g, 'Sintaxi'],
  [/sintaxis/g, 'sintaxi'],
  [/Contacto/g, 'Contacte'],
  [/contacto/g, 'contacte'],
  [/Documentación/g, 'Documentació'],
  [/documentación/g, 'documentació'],
  [/documentos/g, 'documents'],
  [/documento/g, 'document'],
  [/página/g, 'pàgina'],
  [/Página/g, 'Pàgina'],
  [/configuración/g, 'configuració'],
  [/gratuita/g, 'gratuïta'],
  [/gratuito/g, 'gratuït'],
  [/abierto/g, 'obert'],
  [/código/g, 'codi'],
  [/Código/g, 'Codi'],
  [/vista previa/g, 'vista prèvia'],
  [/Vista previa/g, 'Vista prèvia'],
  [/formato/g, 'format'],
  [/Formatos/g, 'Formats'],
  [/contenido/g, 'contingut'],
  [/Contenido/g, 'Contingut'],
  [/lista/g, 'llista'],
  [/Lista/g, 'Llista'],
  [/enlace/g, 'enllaç'],
  [/Enlace/g, 'Enllaç'],
  [/enlaces/g, 'enllaços'],
  [/imagen/g, 'imatge'],
  [/Imagen/g, 'Imatge'],
  [/imágenes/g, 'imatges'],
  [/tabla/g, 'taula'],
  [/Tabla/g, 'Taula'],
  [/tablas/g, 'taules'],
  [/fácil/g, 'fàcil'],
  [/Fácil/g, 'Fàcil'],
  [/simplificar/g, 'simplificar'],
  [/comunidad/g, 'comunitat'],
  [/Comunidad/g, 'Comunitat'],
  [/colaboración/g, 'col·laboració'],
  [/Colaboración/g, 'Col·laboració'],
  [/nuestra/g, 'nostra'],
  [/nuestro/g, 'nostre'],
  [/Nuestra/g, 'Nostra'],
  [/Nuestro/g, 'Nostre'],
  [/tuya/g, 'teva'],
  [/tuyo/g, 'teu'],
  [/tu /g, 'el teu '],
  [/para tu/g, 'per al teu'],
  [/para la/g, 'per a la'],
  [/para el/g, 'per a l\''],
  [/para una/g, 'per a una'],
  [/para un/g, 'per a un'],
  [/y condiciones/g, 'i condicions'],
  [/Términos/g, 'Termes'],
  [/términos/g, 'termes'],
  [/condiciones/g, 'condicions'],
  [/Condiciones/g, 'Condicions'],
  [/Política de privacidad/g, 'Política de privacitat'],
  [/privacidad/g, 'privacitat'],
  [/Privacidad/g, 'Privacitat'],
  [/reservados/g, 'reservats'],
  [/derechos/g, 'drets'],
  [/Todos los derechos/g, 'Tots els drets'],
  [/Bienvenido/g, 'Benvingut'],
  [/Editor/g, 'Editor'],
  [/editor/g, 'editor'],
  [/archivo/g, 'fitxer'],
  [/Archivo/g, 'Fitxer'],
  [/archivos/g, 'fitxers'],
  [/archivos/g, 'fitxers'],
  [/archivo/g, 'fitxer'],
  [/Guardar/g, 'Desar'],
  [/guardar/g, 'desar'],
  [/Abrir/g, 'Obrir'],
  [/abrir/g, 'obrir'],
  [/Cerrar/g, 'Tancar'],
  [/cerrar/g, 'tancar'],
  [/Cancelar/g, 'Cancel·lar'],
  [/cancelar/g, 'cancel·lar'],
  [/Insertar/g, 'Inserir'],
  [/insertar/g, 'inserir'],
  [/Texto/g, 'Text'],
  [/texto/g, 'text'],
  [/Nuevo/g, 'Nou'],
  [/nuevo/g, 'nou'],
  [/nueva/g, 'nova'],
  [/Nueva/g, 'Nova'],
  [/Ocultar/g, 'Amagar'],
  [/ocultar/g, 'amagar'],
  [/Mostrar/g, 'Mostrar'],
  [/mostrar/g, 'mostrar'],
  [/Panel/g, 'Panell'],
  [/panel/g, 'panell'],
  [/Barra lateral/g, 'Barra lateral'],
  [/Deshacer/g, 'Desfer'],
  [/Rehacer/g, 'Refer'],
  [/Encabezado/g, 'Capçalera'],
  [/encabezado/g, 'capçalera'],
  [/encabezados/g, 'capçaleres'],
  [/Negrita/g, 'Negreta'],
  [/negrita/g, 'negreta'],
  [/Cursiva/g, 'Cursiva'],
  [/cursiva/g, 'cursiva'],
  [/Tachado/g, 'Ratllat'],
  [/tachado/g, 'ratllat'],
  [/Cita/g, 'Cita'],
  [/cita/g, 'cita'],
  [/citas/g, 'cites'],
  [/Lista de viñetas/g, 'Llista de vinyetes'],
  [/Lista numerada/g, 'Llista numerada'],
  [/Pantalla completa/g, 'Pantalla completa'],
  [/Salir de pantalla completa/g, 'Sortir de pantalla completa'],
  [/Imprimir/g, 'Imprimir'],
  [/imprimir/g, 'imprimir'],
  [/Descargar/g, 'Descarregar'],
  [/descargar/g, 'descarregar'],
  [/comenzar/g, 'començar'],
  [/Comenzar/g, 'Començar'],
  [/Empezar/g, 'Començar'],
  [/empezar/g, 'començar'],
  [/Guía/g, 'Guia'],
  [/guía/g, 'guia'],
  [/guías/g, 'guies'],
  [/Referencia rápida/g, 'Referència ràpida'],
  [/referencia rápida/g, 'referència ràpida'],
  [/Elemento/g, 'Element'],
  [/elemento/g, 'element'],
  [/elementos/g, 'elements'],
  [/Regla horizontal/g, 'Regla horitzontal'],
  [/Salto de línea/g, 'Salt de línia'],
  [/Bloque de código/g, 'Bloc de codi'],
  [/bloque de código/g, 'bloc de codi'],
  [/bloques de código/g, 'blocs de codi'],
  [/Nota al pie/g, 'Nota al peu'],
  [/Lista de definiciones/g, 'Llista de definicions'],
  [/Diagrama/g, 'Diagrama'],
  [/diagrama/g, 'diagrama'],
  [/Ecuación/g, 'Equació'],
  [/ecuación/g, 'equació'],
  [/Resaltado/g, 'Resaltat'],
  [/resaltado/g, 'resaltat'],
  [/Superíndice/g, 'Superíndex'],
  [/Subíndice/g, 'Subíndex'],
  [/Alineación/g, 'Alineació'],
  [/alineación/g, 'alineació'],
  [/Izquierda/g, 'Esquerra'],
  [/izquierda/g, 'esquerra'],
  [/Centro/g, 'Centre'],
  [/centro/g, 'centre'],
  [/Derecha/g, 'Dreta'],
  [/derecha/g, 'dreta'],
  [/Información/g, 'Informació'],
  [/información/g, 'informació'],
  [/Cookies/g, 'Galetes'],
  [/cookies/g, 'galetes'],
  [/Servicios de terceros/g, 'Serveis de tercers'],
  [/terceros/g, 'tercers'],
  [/Seguridad/g, 'Seguretat'],
  [/seguridad/g, 'seguretat'],
  [/Derechos/g, 'Drets'],
  [/Niños/g, 'Nens'],
  [/niños/g, 'nens'],
  [/Transferencia/g, 'Transferència'],
  [/transferencia/g, 'transferència'],
  [/Cambios/g, 'Canvis'],
  [/cambios/g, 'canvis'],
  [/Licencia/g, 'Llicència'],
  [/licencia/g, 'llicència'],
  [/Descargo de responsabilidad/g, 'Exempció de responsabilitat'],
  [/Limitaciones/g, 'Limitacions'],
  [/limitaciones/g, 'limitacions'],
  [/Contenido del usuario/g, 'Contingut de l\'usuari'],
  [/Usos prohibidos/g, 'Usos prohibits'],
  [/Terminación/g, 'Terminació'],
  [/terminación/g, 'terminació'],
  [/Ley aplicable/g, 'Llei aplicable'],
  [/Convertir/g, 'Convertir'],
  [/convertir/g, 'convertir'],
  [/conversor/g, 'convertidor'],
  [/Conversor/g, 'Convertidor'],
  [/exportar/g, 'exportar'],
  [/Exportar/g, 'Exportar'],
  [/preguntas frecuentes/g, 'preguntes freqüents'],
  [/Preguntas frecuentes/g, 'Preguntes freqüents'],
  [/última actualización/g, 'darrera actualització'],
  [/Última actualización/g, 'Darrera actualització'],
  [/Aceptación/g, 'Acceptació'],
  [/aceptación/g, 'acceptació'],
  [/Contacte nos/g, 'Contacteu-nos'],
  [/Contáctenos/g, 'Contacteu-nos'],
  [/contáctenos/g, 'contacteu-nos'],
  [/Escríbenos/g, 'Escriviu-nos'],
  [/escríbenos/g, 'escriviu-nos'],
  [/repositorio/g, 'repositori'],
  [/Repositorio/g, 'Repositori'],
  [/correo electrónico/g, 'correu electrònic'],
  [/Correo electrónico/g, 'Correu electrònic'],
  [/correo/g, 'correu'],
  [/Correo/g, 'Correu'],
  [/respuesta/g, 'resposta'],
  [/Respuesta/g, 'Resposta'],
  [/consultas/g, 'consultes'],
  [/Consultas/g, 'Consultes'],
  [/dentro de/g, 'en un termini de'],
  [/horas/g, 'hores'],
  [/Gracias/g, 'Gràcies'],
  [/gracias/g, 'gràcies'],
  [/interés/g, 'interès'],
  [/Interés/g, 'Interès'],
  [/Búsqueda/g, 'Cerca'],
  [/búsqueda/g, 'cerca'],
  [/buscando/g, 'buscant'],
  [/Buscando/g, 'Buscant'],
  [/manera/g, 'manera'],
  [/Manera/g, 'Manera'],
  [/instalación/g, 'instal·lació'],
  [/Instalación/g, 'Instal·lació'],
  [/registro/g, 'registre'],
  [/Registro/g, 'Registre'],
  [/Escriba/g, 'Escriviu'],
  [/escriba/g, 'escriviu'],
  [/Escribir/g, 'Escriure'],
  [/escribir/g, 'escriure'],
  [/pegar/g, 'enganxar'],
  [/Pegar/g, 'Enganxar'],
  [/clic/g, 'clic'],
  [/Clic/g, 'Clic'],
  [/haga clic/g, 'feu clic'],
  [/Haga clic/g, 'Feu clic'],
  [/Guardar como/g, 'Desar com'],
  [/guardar como/g, 'desar com'],
  [/destino/g, 'destí'],
  [/Destino/g, 'Destí'],
  [/cuadro de diálogo/g, 'quadre de diàleg'],
  [/Cuadro de diálogo/g, 'Quadre de diàleg'],
  [/icono/g, 'icona'],
  [/Icono/g, 'Icona'],
  [/barra de herramientas/g, 'barra d\'eines'],
  [/Barra de herramientas/g, 'Barra d\'eines'],
  [/archivo PDF/g, 'fitxer PDF'],
  [/Archivo PDF/g, 'Fitxer PDF'],
  [/archivos PDF/g, 'fitxers PDF'],
  [/Obtener/g, 'Obtenir'],
  [/obtener/g, 'obtenir'],
  [/Obtenga/g, 'Obteniu'],
  [/obtenga/g, 'obteniu'],
  [/Listo/g, 'Preparat'],
  [/listo/g, 'preparat'],
  [/Lista para/g, 'Preparat per'],
  [/lista para/g, 'preparat per'],
  [/Recomendado/g, 'Recomanat'],
  [/recomendado/g, 'recomanat'],
  [/Recomendados/g, 'Recomanats'],
  [/recomendados/g, 'recomanats'],
  [/Sugerir/g, 'Suggerir'],
  [/sugerir/g, 'suggerir'],
  [/Sugiera/g, 'Suggeriu'],
  [/Visite/g, 'Visiteu'],
  [/visite/g, 'visiteu'],
  [/Reloj/g, 'Rellotge'],
  [/reloj/g, 'rellotge'],
  [/zona horaria/g, 'zona horària'],
  [/Zona horaria/g, 'Zona horària'],
  [/convertidor de zona horaria/g, 'convertidor de zona horària'],
  [/Convertidor de zona horaria/g, 'Convertidor de zona horària'],
  [/actual/g, 'actual'],
  [/Actual/g, 'Actual'],
  [/entre/g, 'entre'],
  [/ciudades/g, 'ciutats'],
  [/Ciudades/g, 'Ciutats'],
  [/mundo/g, 'món'],
  [/Mundo/g, 'Món'],
  [/desarrolladores/g, 'desenvolupadors'],
  [/Desarrolladores/g, 'Desenvolupadors'],
  [/pilotos/g, 'pilots'],
  [/cualquier persona/g, 'qualsevol persona'],
  [/Cualquier persona/g, 'Qualsevol persona'],
  [/trabajando/g, 'treballant'],
  [/Trabajando/g, 'Treballant'],
  [/zonas horarias/g, 'zones horàries'],
  [/Zonas horarias/g, 'Zones horàries'],
  [/esencial/g, 'essencial'],
  [/Esencial/g, 'Esencial'],
  [/Gratis/g, 'Gratuït'],
  [/gratis/g, 'gratuït'],
  [/en línea/g, 'en línia'],
  [/En línea/g, 'En línia'],
  [/en linea/g, 'en línia'],
  [/En linea/g, 'En línia'],
  [/Simple/g, 'Simple'],
  [/simple/g, 'simple'],
  [/Rápido/g, 'Ràpid'],
  [/rápido/g, 'ràpid'],
  [/Rápidos/g, 'Ràpids'],
  [/rápidos/g, 'ràpids'],
  [/Fácil/g, 'Fàcil'],
  [/Más/g, 'Més'],
  [/más/g, 'més'],
  [/menos/g, 'menys'],
  [/Menos/g, 'Menys'],
  [/También/g, 'També'],
  [/también/g, 'també'],
  [/Todavía/g, 'Encara'],
  [/todavía/g, 'encara'],
  [/Solo/g, 'Només'],
  [/solo/g, 'només'],
  [/Sólo/g, 'Només'],
  [/sólo/g, 'només'],
  [/Ahora/g, 'Ara'],
  [/ahora/g, 'ara'],
  [/Entonces/g, 'Llavors'],
  [/entonces/g, 'llavors'],
  [/Cuando/g, 'Quan'],
  [/cuando/g, 'quan'],
  [/Donde/g, 'On'],
  [/donde/g, 'on'],
  [/Cómo/g, 'Com'],
  [/cómo/g, 'com'],
  [/Qué/g, 'Què'],
  [/qué/g, 'què'],
  [/Por qué/g, 'Per què'],
  [/por qué/g, 'per què'],
  [/Cuál/g, 'Quin'],
  [/cuál/g, 'quin'],
  [/Cuáles/g, 'Quins'],
  [/cuáles/g, 'quins'],
  [/Este/g, 'Aquest'],
  [/este/g, 'aquest'],
  [/Esta/g, 'Aquesta'],
  [/esta/g, 'aquesta'],
  [/Estos/g, 'Aquests'],
  [/estos/g, 'aquests'],
  [/Estas/g, 'Aquestes'],
  [/estas/g, 'aquestes'],
  [/Ese/g, 'Aquel'],
  [/ese/g, 'aquel'],
  [/Esa/g, 'Aquella'],
  [/esa/g, 'aquella'],
  [/Esos/g, 'Aquells'],
  [/esos/g, 'aquells'],
  [/Esas/g, 'Aquelles'],
  [/esas/g, 'aquelles'],
  [/Otro/g, 'Un altre'],
  [/otro/g, 'un altre'],
  [/Otros/g, 'Uns altres'],
  [/otros/g, 'uns altres'],
  [/Otra/g, 'Una altra'],
  [/otra/g, 'una altra'],
  [/Otras/g, 'Unes altres'],
  [/otras/g, 'unes altres'],
  [/Todos/g, 'Tots'],
  [/todos/g, 'tots'],
  [/Todas/g, 'Totes'],
  [/todas/g, 'totes'],
  [/Todo/g, 'Tot'],
  [/todo/g, 'tot'],
  [/Toda/g, 'Tota'],
  [/toda/g, 'tota'],
  [/Nadie/g, 'Ningú'],
  [/nadie/g, 'ningú'],
  [/Nada/g, 'Res'],
  [/nada/g, 'res'],
  [/Nunca/g, 'Mai'],
  [/nunca/g, 'mai'],
  [/Siempre/g, 'Sempre'],
  [/siempre/g, 'sempre'],
  [/Aquí/g, 'Aquí'],
  [/aquí/g, 'aquí'],
  [/Allí/g, 'Allà'],
  [/allí/g, 'allà'],
  [/Allá/g, 'Allà'],
  [/allá/g, 'allà'],
  [/Después/g, 'Després'],
  [/después/g, 'després'],
  [/Antes/g, 'Abans'],
  [/antes/g, 'abans'],
  [/Durante/g, 'Durant'],
  [/durante/g, 'durant'],
  [/Hacia/g, 'Cap a'],
  [/hacia/g, 'cap a'],
  [/Según/g, 'Segons'],
  [/según/g, 'segons'],
  [/Sin/g, 'Sense'],
  [/sin/g, 'sense'],
  [/Sobre/g, 'Sobre'],
  [/sobre/g, 'sobre'],
  [/Bajo/g, 'Sota'],
  [/bajo/g, 'sota'],
  [/Entre/g, 'Entre'],
  [/entre/g, 'entre'],
  [/Hasta/g, 'Fins'],
  [/hasta/g, 'fins'],
  [/Desde/g, 'Des de'],
  [/desde/g, 'des de'],
  [/Mediante/g, 'Mitjançant'],
  [/mediante/g, 'mitjançant'],
  [/Seguridad de datos/g, 'Seguretat de dades'],
  [/seguridad de datos/g, 'seguretat de dades'],
  [/Datos/g, 'Dades'],
  [/datos/g, 'dades'],
  [/Información que recopilamos/g, 'Informació que recopilem'],
  [/información que recopilamos/g, 'informació que recopilem'],
  [/Cómo utilizamos/g, 'Com utilitzem'],
  [/cómo utilizamos/g, 'com utilitzem'],
  [/su información/g, 'la vostra informació'],
  [/Su información/g, 'La vostra informació'],
  [/Privacidad de los niños/g, 'Privacitat dels nens'],
  [/privacidad de los niños/g, 'privacitat dels nens'],
  [/Transferencia de datos internacional/g, 'Transferència de dades internacional'],
  [/Cambios a esta política/g, 'Canvis a aquesta política'],
  [/cambios a esta política/g, 'canvis a aquesta política'],
  [/Contáctenos/g, 'Contacteu-nos'],
  [/Aceptación de los términos/g, 'Acceptació dels termes'],
  [/Uso de la licencia/g, 'Ús de la llicència'],
  [/Contenido del usuario/g, 'Contingut de l\'usuari'],
  [/Usos prohibidos/g, 'Usos prohibits'],
  [/Cambios a los términos/g, 'Canvis als termes'],
  [/Ley aplicable/g, 'Llei aplicable'],
  [/Información de contacto/g, 'Informació de contacte'],
];

function applySubstitutions(str) {
  if (typeof str !== 'string') return str;
  let out = str;
  for (const [from, to] of subs) out = out.replace(from, to);
  return out;
}

const out = {};
for (const key of Object.keys(en)) {
  if (key.startsWith('$')) continue;
  const val = es[key] !== undefined ? es[key] : en[key];
  out[key] = typeof val === 'string' ? applySubstitutions(val) : val;
}

fs.mkdirSync(path.dirname(outPath), { recursive: true });
fs.writeFileSync(outPath, JSON.stringify(out, null, 2) + '\n', 'utf8');
console.log('Built', outPath, 'from es.json with Catalan substitutions.');